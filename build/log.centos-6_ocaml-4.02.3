Running this Dockerfile:
FROM ocaml/opam:centos-6_ocaml-4.02.3
RUN sudo -u opam sh -c "cd /home/opam/opam-repository && git pull origin master && opam update -u" && \
  sudo -u opam sh -c "cd /home/opam/opam-repository && git pull https://github.com/samoht/opam-repository.git master && opam update -u" && \
  sudo -u opam sh -c "opam depext -u mirage mirage-unix mirage-xen" && \
  sudo -u opam sh -c "opam install -y -j 2 -v mirage mirage-unix mirage-xen"Sending build context to Docker daemon 37.38 kB
Step 1 : FROM ocaml/opam:centos-6_ocaml-4.02.3
centos-6_ocaml-4.02.3: Pulling from ocaml/opam
a3ed95caeb02: Already exists
204c9415d16d: Already exists
a3ed95caeb02: Already exists
a3ed95caeb02: Already exists
a223479fbf94: Already exists
237f65bdc150: Already exists
e3f8588f2934: Already exists
Digest: sha256:035437a635e86955863cfa11701cc0f370c27ac1fad88f6c63fc0704aa47aeac
Status: Image is up to date for ocaml/opam:centos-6_ocaml-4.02.3
 ---> 5a52ad74a37a
Step 2 : RUN sudo -u opam sh -c "cd /home/opam/opam-repository && git pull origin master && opam update -u" &&   sudo -u opam sh -c "cd /home/opam/opam-repository && git pull https://github.com/samoht/opam-repository.git master && opam update -u" &&   sudo -u opam sh -c "opam depext -u mirage mirage-unix mirage-xen" &&   sudo -u opam sh -c "opam install -y -j 2 -v mirage mirage-unix mirage-xen"
 ---> Running in 50b02528bacc
[91mFrom git://github.com/ocaml/opam-repository
 * branch            master     -> FETCH_HEAD
[0mUpdating 8223d0d..8851f94
Fast-forward
 packages/async_ssl/async_ssl.113.24.00/opam        |    6 +---
 packages/async_ssl/async_ssl.113.33.00/opam        |    6 +---
 packages/conf-m4/conf-m4.1/opam                    |    1 +
 packages/conf-ncurses/conf-ncurses.1/opam          |    1 +
 packages/conf-openssl/conf-openssl.1/opam          |    1 +
 packages/conf-pkg-config/conf-pkg-config.1.0/opam  |    1 +
 packages/dbm/dbm.1.0/files/mkdir-stublibs.patch    |   17 +++++++++
 packages/dbm/dbm.1.0/opam                          |    1 +
 packages/mirage/mirage.2.7.1/opam                  |   32 -----------------
 packages/mirage/mirage.2.7.1/url                   |    2 -
 .../mirage/{mirage.2.7.1 => mirage.2.7.2}/descr    |    0
 packages/mirage/mirage.2.7.2/opam                  |   36 ++++++++++++++++++++
 packages/mirage/mirage.2.7.2/url                   |    2 +
 packages/re2/re2.112.06.00/opam                    |    2 +-
 packages/re2/re2.112.35.00/opam                    |    2 +-
 packages/re2/re2.113.00.00/opam                    |    2 +-
 packages/re2/re2.113.24.00/opam                    |    2 +-
 packages/re2/re2.113.33.00/opam                    |    4 ++
 .../shared-memory-ring.1.3.0/descr                 |    3 ++
 .../shared-memory-ring.1.3.0/findlib               |    1 +
 .../shared-memory-ring.1.3.0/opam                  |   26 ++++++++++++++
 .../shared-memory-ring.1.3.0/url                   |    2 +
 packages/vmnet/vmnet.1.0.0/opam                    |    6 +++-
 packages/vmnet/vmnet.1.0.1/opam                    |    6 +++-
 packages/vmnet/vmnet.1.0.2/opam                    |    6 +++-
 packages/vmnet/vmnet.1.1.0/descr                   |   30 ++++++++++++++++
 packages/vmnet/vmnet.1.1.0/opam                    |   28 +++++++++++++++
 packages/vmnet/vmnet.1.1.0/url                     |    2 +
 28 files changed, 177 insertions(+), 51 deletions(-)
 create mode 100644 packages/dbm/dbm.1.0/files/mkdir-stublibs.patch
 delete mode 100644 packages/mirage/mirage.2.7.1/opam
 delete mode 100644 packages/mirage/mirage.2.7.1/url
 rename packages/mirage/{mirage.2.7.1 => mirage.2.7.2}/descr (100%)
 create mode 100644 packages/mirage/mirage.2.7.2/opam
 create mode 100644 packages/mirage/mirage.2.7.2/url
 create mode 100644 packages/shared-memory-ring/shared-memory-ring.1.3.0/descr
 create mode 100644 packages/shared-memory-ring/shared-memory-ring.1.3.0/findlib
 create mode 100644 packages/shared-memory-ring/shared-memory-ring.1.3.0/opam
 create mode 100644 packages/shared-memory-ring/shared-memory-ring.1.3.0/url
 create mode 100644 packages/vmnet/vmnet.1.1.0/descr
 create mode 100644 packages/vmnet/vmnet.1.1.0/opam
 create mode 100644 packages/vmnet/vmnet.1.1.0/url

=-=- Updating package repositories =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[default: local] Command started
[default: local] Command started
[default: local] Command started
[default] /home/opam/opam-repository synchronized

=-=- Synchronizing development packages -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[depext: git] Command started
[depext: git] Command started
[depext: git] Command started
[depext: git] Command started
[depext] https://github.com/ocaml/opam-depext.git already up-to-date

Everything as up-to-date as possible (run with --verbose to show unavailable
upgrades).
[91mFrom https://github.com/samoht/opam-repository
 * branch            master     -> FETCH_HEAD
[0mRemoving packages/mirage/mirage.2.7.2/url
Merge made by recursive.
 packages/mirage/mirage.2.7.2/url                   |    2 --
 .../mirage/{mirage.2.7.2 => mirage.2.7.3}/descr    |    0
 .../mirage/{mirage.2.7.2 => mirage.2.7.3}/opam     |    0
 packages/mirage/mirage.2.7.3/url                   |    2 ++
 4 files changed, 2 insertions(+), 2 deletions(-)
 delete mode 100644 packages/mirage/mirage.2.7.2/url
 rename packages/mirage/{mirage.2.7.2 => mirage.2.7.3}/descr (100%)
 rename packages/mirage/{mirage.2.7.2 => mirage.2.7.3}/opam (100%)
 create mode 100644 packages/mirage/mirage.2.7.3/url

=-=- Updating package repositories =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[default: local] Command started
[default: local] Command started
[default: local] Command started
[default] /home/opam/opam-repository synchronized

=-=- Synchronizing development packages -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[depext: git] Command started
[depext: git] Command started
[depext: git] Command started
[depext: git] Command started
[depext] https://github.com/ocaml/opam-depext.git already up-to-date

Everything as up-to-date as possible (run with --verbose to show unavailable
upgrades).
# Detecting depexts using flags: x86_64 linux centos
# The following system packages are needed:
#  - m4
#  - ncurses-devel
#  - pkgconfig
#  - xen-devel
Name        : m4                           Relocations: (not relocatable)
Version     : 1.4.13                            Vendor: CentOS
Release     : 5.el6                         Build Date: Thu Nov 11 17:17:34 2010
Install Date: Wed Mar 16 14:18:40 2016         Build Host: c6b3.bsys.dev.centos.org
Group       : Applications/Text             Source RPM: m4-1.4.13-5.el6.src.rpm
Size        : 560949                           License: GPLv3+
Signature   : RSA/8, Sun Jul  3 04:44:33 2011, Key ID 0946fca2c105b9de
Packager    : CentOS BuildSystem <http://bugs.centos.org>
URL         : http://www.gnu.org/software/m4/
Summary     : The GNU macro processor
Description :
A GNU implementation of the traditional UNIX macro processor.  M4 is
useful for writing text files which can be logically parsed, and is used
by many programs as part of their build process.  M4 has built-in
functions for including files, running shell commands, doing arithmetic,
etc.  The autoconf program needs m4 for generating configure scripts, but
not for running configure scripts.

Install m4 if you need a macro processor.
Name        : ncurses-devel                Relocations: (not relocatable)
Version     : 5.7                               Vendor: CentOS
Release     : 4.20090207.el6                Build Date: Mon Mar 16 08:54:02 2015
Install Date: Wed Mar 16 14:19:26 2016         Build Host: c6b9.bsys.dev.centos.org
Group       : Development/Libraries         Source RPM: ncurses-5.7-4.20090207.el6.src.rpm
Size        : 1795830                          License: MIT
Signature   : RSA/SHA1, Mon Mar 16 14:43:08 2015, Key ID 0946fca2c105b9de
Packager    : CentOS BuildSystem <http://bugs.centos.org>
URL         : http://invisible-island.net/ncurses/ncurses.html
Summary     : Development files for the ncurses library
Description :
The header files and libraries for developing applications that use
the ncurses terminal handling library.

Install the ncurses-devel package if you want to develop applications
which will use ncurses.
Name        : pkgconfig                    Relocations: (not relocatable)
Version     : 0.23                              Vendor: CentOS
Release     : 9.1.el6                       Build Date: Thu Aug 19 03:30:32 2010
Install Date: Fri Mar  4 06:26:08 2016         Build Host: c6b1.bsys.dev.centos.org
Group       : Development/Tools             Source RPM: pkgconfig-0.23-9.1.el6.src.rpm
Size        : 140091                           License: GPLv2+
Signature   : RSA/8, Sun Jul  3 04:57:05 2011, Key ID 0946fca2c105b9de
Packager    : CentOS BuildSystem <http://bugs.centos.org>
URL         : http://pkgconfig.freedesktop.org
Summary     : A tool for determining compilation options
Description :
The pkgconfig tool determines compilation options. For each required
library, it reads the configuration file and outputs the necessary
compiler and linker flags.
package xen-devel is not installed
# The following new OS packages need to be installed: xen-devel
The following command needs to be run through "sudo":
    yum -y update
Loaded plugins: fastestmirror
Setting up Update Process
Determining fastest mirrors
 * base: centos.serverspace.co.uk
 * extras: mirror.vorboss.net
 * updates: mirror.sov.uk.goscomb.net
Resolving Dependencies
--> Running transaction check
---> Package bind-libs.x86_64 32:9.8.2-0.37.rc1.el6_7.6 will be updated
---> Package bind-libs.x86_64 32:9.8.2-0.37.rc1.el6_7.7 will be an update
---> Package bind-utils.x86_64 32:9.8.2-0.37.rc1.el6_7.6 will be updated
---> Package bind-utils.x86_64 32:9.8.2-0.37.rc1.el6_7.7 will be an update
---> Package libssh2.x86_64 0:1.4.2-1.el6_6.1 will be updated
---> Package libssh2.x86_64 0:1.4.2-2.el6_7.1 will be an update
---> Package nss-util.x86_64 0:3.19.1-2.el6_7 will be updated
---> Package nss-util.x86_64 0:3.19.1-5.el6_7 will be an update
---> Package tzdata.noarch 0:2016a-2.el6 will be updated
---> Package tzdata.noarch 0:2016b-1.el6 will be an update
--> Finished Dependency Resolution

Dependencies Resolved

================================================================================
 Package         Arch        Version                         Repository    Size
================================================================================
Updating:
 bind-libs       x86_64      32:9.8.2-0.37.rc1.el6_7.7       updates      887 k
 bind-utils      x86_64      32:9.8.2-0.37.rc1.el6_7.7       updates      186 k
 libssh2         x86_64      1.4.2-2.el6_7.1                 updates      123 k
 nss-util        x86_64      3.19.1-5.el6_7                  updates       67 k
 tzdata          noarch      2016b-1.el6                     updates      446 k

Transaction Summary
================================================================================
Upgrade       5 Package(s)

Total download size: 1.7 M
Downloading Packages:
--------------------------------------------------------------------------------
Total                                           1.4 MB/s | 1.7 MB     00:01     
Running rpm_check_debug
Running Transaction Test
Transaction Test Succeeded
Running Transaction
  Updating   : 32:bind-libs-9.8.2-0.37.rc1.el6_7.7.x86_64                  1/10 
  Updating   : 32:bind-utils-9.8.2-0.37.rc1.el6_7.7.x86_64                 2/10 
  Updating   : nss-util-3.19.1-5.el6_7.x86_64                              3/10 
  Updating   : tzdata-2016b-1.el6.noarch                                   4/10 
  Updating   : libssh2-1.4.2-2.el6_7.1.x86_64                              5/10 
  Cleanup    : 32:bind-utils-9.8.2-0.37.rc1.el6_7.6.x86_64                 6/10 
  Cleanup    : tzdata-2016a-2.el6.noarch                                   7/10 
  Cleanup    : 32:bind-libs-9.8.2-0.37.rc1.el6_7.6.x86_64                  8/10 
  Cleanup    : nss-util-3.19.1-2.el6_7.x86_64                              9/10 
  Cleanup    : libssh2-1.4.2-1.el6_6.1.x86_64                             10/10 
  Verifying  : libssh2-1.4.2-2.el6_7.1.x86_64                              1/10 
  Verifying  : 32:bind-utils-9.8.2-0.37.rc1.el6_7.7.x86_64                 2/10 
  Verifying  : tzdata-2016b-1.el6.noarch                                   3/10 
  Verifying  : nss-util-3.19.1-5.el6_7.x86_64                              4/10 
  Verifying  : 32:bind-libs-9.8.2-0.37.rc1.el6_7.7.x86_64                  5/10 
  Verifying  : 32:bind-libs-9.8.2-0.37.rc1.el6_7.6.x86_64                  6/10 
  Verifying  : libssh2-1.4.2-1.el6_6.1.x86_64                              7/10 
  Verifying  : nss-util-3.19.1-2.el6_7.x86_64                              8/10 
  Verifying  : 32:bind-utils-9.8.2-0.37.rc1.el6_7.6.x86_64                 9/10 
  Verifying  : tzdata-2016a-2.el6.noarch                                  10/10 

Updated:
  bind-libs.x86_64 32:9.8.2-0.37.rc1.el6_7.7                                    
  bind-utils.x86_64 32:9.8.2-0.37.rc1.el6_7.7                                   
  libssh2.x86_64 0:1.4.2-2.el6_7.1                                              
  nss-util.x86_64 0:3.19.1-5.el6_7                                              
  tzdata.noarch 0:2016b-1.el6                                                   

Complete!
# OS package update successful
The following command needs to be run through "sudo":
    yum install -y xen-devel
Loaded plugins: fastestmirror
Setting up Install Process
Loading mirror speeds from cached hostfile
 * base: centos.serverspace.co.uk
 * extras: mirror.vorboss.net
 * updates: mirror.sov.uk.goscomb.net
No package xen-devel available.
[91mError: Nothing to do
[0m[91mOS package installation failed
[0mThe command '/bin/sh -c sudo -u opam sh -c "cd /home/opam/opam-repository && git pull origin master && opam update -u" &&   sudo -u opam sh -c "cd /home/opam/opam-repository && git pull https://github.com/samoht/opam-repository.git master && opam update -u" &&   sudo -u opam sh -c "opam depext -u mirage mirage-unix mirage-xen" &&   sudo -u opam sh -c "opam install -y -j 2 -v mirage mirage-unix mirage-xen"' returned a non-zero code: 1
