Running this Dockerfile:
FROM ocaml/opam:fedora-22_ocaml-4.03.0_trunk
RUN sudo -u opam sh -c "cd /home/opam/opam-repository && git pull origin master && opam update -u" && \
  sudo -u opam sh -c "cd /home/opam/opam-repository && git pull https://github.com/UnixJunkie/opam-repository.git cairo-use-conf-autoconf && opam update -u" && \
  sudo -u opam sh -c "opam depext -u planets" && \
  sudo -u opam sh -c "opam install -y -j 2 -v planets"Sending build context to Docker daemon 356.9 kB
Step 1 : FROM ocaml/opam:fedora-22_ocaml-4.03.0_trunk
fedora-22_ocaml-4.03.0_trunk: Pulling from ocaml/opam
a3ed95caeb02: Already exists
0967f2c8ac7a: Already exists
42280db5f9e4: Already exists
e7a79521b724: Already exists
ecd921517f3d: Already exists
Digest: sha256:52e380e0e732a7557a0dd5bf194eb323dcda75d4a9a2c656c52e79177300468c
Status: Image is up to date for ocaml/opam:fedora-22_ocaml-4.03.0_trunk
 ---> 160e08ca3fcb
Step 2 : RUN sudo -u opam sh -c "cd /home/opam/opam-repository && git pull origin master && opam update -u" &&   sudo -u opam sh -c "cd /home/opam/opam-repository && git pull https://github.com/UnixJunkie/opam-repository.git cairo-use-conf-autoconf && opam update -u" &&   sudo -u opam sh -c "opam depext -u planets" &&   sudo -u opam sh -c "opam install -y -j 2 -v planets"
 ---> Running in 0073b52d572b
[91mFrom git://github.com/ocaml/opam-repository
 * branch            master     -> FETCH_HEAD
[0m[91m   6f6eed5..080baea  master     -> origin/master
[0mUpdating 6f6eed5..080baea
Fast-forward
 packages/0install/0install.2.6.2/opam              |  1 +
 packages/0install/0install.2.8/opam                |  3 +-
 packages/0install/0install.2.9.1/opam              |  1 +
 packages/cmark/cmark.0.2.0/descr                   |  1 +
 packages/cmark/cmark.0.2.0/opam                    | 19 ++++++++
 packages/cmark/cmark.0.2.0/url                     |  2 +
 packages/conf-wxwidgets/conf-wxwidgets.3.0/descr   |  2 +
 packages/conf-wxwidgets/conf-wxwidgets.3.0/opam    | 11 +++++
 packages/llvm/llvm.3.8/descr                       |  3 ++
 packages/llvm/llvm.3.8/files/install.sh            | 50 ++++++++++++++++++++++
 packages/llvm/llvm.3.8/opam                        | 23 ++++++++++
 packages/llvm/llvm.3.8/url                         |  2 +
 packages/mirage-unix/mirage-unix.2.4.1/descr       |  1 +
 packages/mirage-unix/mirage-unix.2.4.1/opam        | 23 ++++++++++
 packages/mirage-unix/mirage-unix.2.4.1/url         |  2 +
 .../mirage-xen-minios/mirage-xen-minios.0.7.0/opam |  5 ++-
 packages/mirage-xen/mirage-xen.2.4.1/descr         |  3 ++
 packages/mirage-xen/mirage-xen.2.4.1/opam          | 30 +++++++++++++
 packages/mirage-xen/mirage-xen.2.4.1/url           |  2 +
 packages/msat/msat.0.2/opam                        |  1 +
 packages/pcap-format/pcap-format.0.3.1/opam        | 10 +++++
 packages/pcap-format/pcap-format.0.3.2/opam        | 10 +++++
 packages/pcap-format/pcap-format.0.3.3/opam        | 14 +++++-
 packages/ppx_expect/ppx_expect.113.33.01/descr     |  2 +
 packages/ppx_expect/ppx_expect.113.33.01/opam      | 30 +++++++++++++
 packages/ppx_expect/ppx_expect.113.33.01/url       |  2 +
 packages/stog-rdf/stog-rdf.0.10.0/opam             | 12 ++++--
 packages/stog-rdf/stog-rdf.0.11.0/opam             | 12 ++++--
 packages/stog-rdf/stog-rdf.0.15.0/opam             |  2 +-
 packages/stog-rdf/stog-rdf.0.16.0/opam             |  2 +-
 packages/stog-rdf/stog-rdf.0.6/descr               |  1 -
 packages/stog-rdf/stog-rdf.0.6/opam                | 12 ------
 packages/stog-rdf/stog-rdf.0.6/url                 |  2 -
 packages/stog-rdf/stog-rdf.0.8.0/descr             |  1 -
 packages/stog-rdf/stog-rdf.0.8.0/opam              | 12 ------
 packages/stog-rdf/stog-rdf.0.8.0/url               |  2 -
 packages/stog-rdf/stog-rdf.0.9.0/descr             |  1 -
 packages/stog-rdf/stog-rdf.0.9.0/findlib           |  1 -
 packages/stog-rdf/stog-rdf.0.9.0/opam              | 16 -------
 packages/stog-rdf/stog-rdf.0.9.0/url               |  2 -
 .../toplevel_expect_test.113.33.01/descr           |  5 +++
 .../toplevel_expect_test.113.33.01/opam            | 31 ++++++++++++++
 .../toplevel_expect_test.113.33.01/url             |  2 +
 .../toplevel_expect_test.113.33.02/descr           |  5 +++
 .../toplevel_expect_test.113.33.02/opam            | 31 ++++++++++++++
 .../toplevel_expect_test.113.33.02/url             |  2 +
 packages/wxOCaml/wxOCaml.1.0.1/opam                |  5 +--
 47 files changed, 347 insertions(+), 65 deletions(-)
 create mode 100644 packages/cmark/cmark.0.2.0/descr
 create mode 100644 packages/cmark/cmark.0.2.0/opam
 create mode 100644 packages/cmark/cmark.0.2.0/url
 create mode 100644 packages/conf-wxwidgets/conf-wxwidgets.3.0/descr
 create mode 100644 packages/conf-wxwidgets/conf-wxwidgets.3.0/opam
 create mode 100644 packages/llvm/llvm.3.8/descr
 create mode 100755 packages/llvm/llvm.3.8/files/install.sh
 create mode 100644 packages/llvm/llvm.3.8/opam
 create mode 100644 packages/llvm/llvm.3.8/url
 create mode 100644 packages/mirage-unix/mirage-unix.2.4.1/descr
 create mode 100644 packages/mirage-unix/mirage-unix.2.4.1/opam
 create mode 100644 packages/mirage-unix/mirage-unix.2.4.1/url
 create mode 100644 packages/mirage-xen/mirage-xen.2.4.1/descr
 create mode 100644 packages/mirage-xen/mirage-xen.2.4.1/opam
 create mode 100644 packages/mirage-xen/mirage-xen.2.4.1/url
 create mode 100644 packages/ppx_expect/ppx_expect.113.33.01/descr
 create mode 100644 packages/ppx_expect/ppx_expect.113.33.01/opam
 create mode 100644 packages/ppx_expect/ppx_expect.113.33.01/url
 delete mode 100644 packages/stog-rdf/stog-rdf.0.6/descr
 delete mode 100644 packages/stog-rdf/stog-rdf.0.6/opam
 delete mode 100644 packages/stog-rdf/stog-rdf.0.6/url
 delete mode 100644 packages/stog-rdf/stog-rdf.0.8.0/descr
 delete mode 100644 packages/stog-rdf/stog-rdf.0.8.0/opam
 delete mode 100644 packages/stog-rdf/stog-rdf.0.8.0/url
 delete mode 100644 packages/stog-rdf/stog-rdf.0.9.0/descr
 delete mode 100644 packages/stog-rdf/stog-rdf.0.9.0/findlib
 delete mode 100644 packages/stog-rdf/stog-rdf.0.9.0/opam
 delete mode 100644 packages/stog-rdf/stog-rdf.0.9.0/url
 create mode 100644 packages/toplevel_expect_test/toplevel_expect_test.113.33.01/descr
 create mode 100644 packages/toplevel_expect_test/toplevel_expect_test.113.33.01/opam
 create mode 100644 packages/toplevel_expect_test/toplevel_expect_test.113.33.01/url
 create mode 100644 packages/toplevel_expect_test/toplevel_expect_test.113.33.02/descr
 create mode 100644 packages/toplevel_expect_test/toplevel_expect_test.113.33.02/opam
 create mode 100644 packages/toplevel_expect_test/toplevel_expect_test.113.33.02/url

=-=- Updating package repositories =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[default: local] Command started
[default: local] Command started
[default: local] Command started
[default] /home/opam/opam-repository synchronized

Everything as up-to-date as possible (run with --verbose to show unavailable
upgrades).
[91mFrom https://github.com/UnixJunkie/opam-repository
 * branch            cairo-use-conf-autoconf -> FETCH_HEAD
[0mMerge made by the 'recursive' strategy.
 packages/cairo/cairo.0.4.1/opam | 7 +++----
 packages/cairo/cairo.0.4.2/opam | 7 +++----
 packages/cairo/cairo.1.2.0/opam | 7 ++-----
 3 files changed, 8 insertions(+), 13 deletions(-)

=-=- Updating package repositories =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[default: local] Command started
[default: local] Command started
[default: local] Command started
[default] /home/opam/opam-repository synchronized

Everything as up-to-date as possible (run with --verbose to show unavailable
upgrades).
# Detecting depexts using flags: x86_64 linux fedora
# The following system packages are needed:
#  - m4
#  - ncurses-devel
#  - pkgconfig
package m4 is not installed
package ncurses-devel is not installed
Name        : pkgconfig
Epoch       : 1
Version     : 0.28
Release     : 8.fc22
Architecture: x86_64
Install Date: Thu Feb 18 13:57:49 2016
Group       : Development/Tools
Size        : 107920
License     : GPLv2+
Signature   : RSA/SHA256, Sun Apr 19 17:11:52 2015, Key ID 11adc0948e1431d5
Source RPM  : pkgconfig-0.28-8.fc22.src.rpm
Build Date  : Fri Apr 17 19:27:15 2015
Build Host  : buildvm-06.phx2.fedoraproject.org
Relocations : (not relocatable)
Packager    : Fedora Project
Vendor      : Fedora Project
URL         : http://pkgconfig.freedesktop.org
Summary     : A tool for determining compilation options
Description :
The pkgconfig tool determines compilation options. For each required
library, it reads the configuration file and outputs the necessary
compiler and linker flags.
# The following new OS packages need to be installed: m4 ncurses-devel
Not running as root, the following command will be run through "sudo":
    yum -y update
[91mYum command has been deprecated, redirecting to '/usr/bin/dnf -y update'.
See 'man dnf' and 'man yum2dnf' for more information.
To transfer transaction metadata from yum to DNF, run:
'dnf install python-dnf-plugins-extras-migrate && dnf-2 migrate'

[0mLast metadata expiration check performed 0:00:14 ago on Wed Mar 23 13:48:15 2016.
Dependencies resolved.
================================================================================
 Package                 Arch        Version                 Repository    Size
================================================================================
Installing:
 kernel-debug-devel      x86_64      4.4.5-200.fc22          updates       10 M
 python-pip              noarch      6.0.8-1.fc22            fedora       1.7 M
 python-setuptools       noarch      17.1.1-3.fc22           updates      425 k
 sqlite-libs             x86_64      3.11.0-3.fc22           updates      449 k
     replacing  sqlite.x86_64 3.10.2-1.fc22
Upgrading:
 gnupg2                  x86_64      2.1.11-1.fc22           updates      1.9 M
 kernel-headers          x86_64      4.4.5-200.fc22          updates      1.0 M
 libssh2                 x86_64      1.5.0-2.fc22            updates      145 k
 nspr                    x86_64      4.12.0-1.fc22           updates      135 k
 nss                     x86_64      3.23.0-1.0.fc22         updates      871 k
 nss-softokn             x86_64      3.23.0-1.0.fc22         updates      317 k
 nss-softokn-freebl      x86_64      3.23.0-1.0.fc22         updates      214 k
 nss-sysinit             x86_64      3.23.0-1.0.fc22         updates       57 k
 nss-tools               x86_64      3.23.0-1.0.fc22         updates      493 k
 nss-util                x86_64      3.23.0-1.0.fc22         updates       82 k
 openssl-libs            x86_64      1:1.0.1k-14.fc22        updates      943 k
 pcre                    x86_64      8.38-3.fc22             updates      495 k
 python                  x86_64      2.7.10-8.fc22           updates       93 k
 python-libs             x86_64      2.7.10-8.fc22           updates      5.8 M
 sqlite                  x86_64      3.11.0-3.fc22           updates      473 k

Transaction Summary
================================================================================
Install   4 Packages
Upgrade  15 Packages

Total download size: 25 M
Downloading Packages:
[91m/usr/share/doc/libssh2/AUTHORS: No such file or directory
cannot reconstruct rpm from disk files
[0m[91m/usr/share/doc/python-libs/README: No such file or directory
cannot reconstruct rpm from disk files
[0mpython-libs-2.7.10-8.fc22.x86_64: Delta RPM rebuild failed
libssh2-1.5.0-2.fc22.x86_64: Delta RPM rebuild failed
--------------------------------------------------------------------------------
Total                                           617 kB/s |  17 MB     00:27     
Delta RPMs reduced 25.4 MB of updates to 16.7 MB (34.1% saved)
Running transaction check
Transaction check succeeded.
Running transaction test
Transaction test succeeded.
Running transaction
  Upgrading   : nspr-4.12.0-1.fc22.x86_64                                  1/34 
warning: Unable to get systemd shutdown inhibition lock
  Upgrading   : nss-util-3.23.0-1.0.fc22.x86_64                            2/34 
  Installing  : sqlite-libs-3.11.0-3.fc22.x86_64                           3/34 
  Upgrading   : openssl-libs-1:1.0.1k-14.fc22.x86_64                       4/34 
  Upgrading   : nss-softokn-freebl-3.23.0-1.0.fc22.x86_64                  5/34 
  Upgrading   : nss-softokn-3.23.0-1.0.fc22.x86_64                         6/34 
  Upgrading   : nss-sysinit-3.23.0-1.0.fc22.x86_64                         7/34 
  Upgrading   : nss-3.23.0-1.0.fc22.x86_64                                 8/34 
  Upgrading   : python-libs-2.7.10-8.fc22.x86_64                           9/34 
  Installing  : python-setuptools-17.1.1-3.fc22.noarch                    10/34 
  Upgrading   : python-2.7.10-8.fc22.x86_64                               11/34 
  Installing  : python-pip-6.0.8-1.fc22.noarch                            12/34 
  Upgrading   : nss-tools-3.23.0-1.0.fc22.x86_64                          13/34 
  Upgrading   : libssh2-1.5.0-2.fc22.x86_64                               14/34 
  Upgrading   : gnupg2-2.1.11-1.fc22.x86_64                               15/34 
  Upgrading   : sqlite-3.11.0-3.fc22.x86_64                               16/34 
  Upgrading   : pcre-8.38-3.fc22.x86_64                                   17/34 
  Upgrading   : kernel-headers-4.4.5-200.fc22.x86_64                      18/34 
  Installing  : kernel-debug-devel-4.4.5-200.fc22.x86_64                  19/34 
  Cleanup     : kernel-headers-4.4.4-200.fc22.x86_64                      20/34 
  Cleanup     : nss-tools-3.21.0-1.1.fc22.x86_64                          21/34 
  Cleanup     : nss-sysinit-3.21.0-1.1.fc22.x86_64                        22/34 
  Cleanup     : nss-3.21.0-1.1.fc22.x86_64                                23/34 
  Cleanup     : nss-softokn-3.21.0-1.1.fc22.x86_64                        24/34 
  Cleanup     : nss-util-3.21.0-1.0.fc22.x86_64                           25/34 
  Cleanup     : python-2.7.9-6.fc22.x86_64                                26/34 
  Cleanup     : python-libs-2.7.9-6.fc22.x86_64                           27/34 
  Cleanup     : libssh2-1.5.0-1.fc22.x86_64                               28/34 
  Cleanup     : openssl-libs-1:1.0.1k-13.fc22.x86_64                      29/34 
  Cleanup     : sqlite-3.10.2-1.fc22.x86_64                               30/34 
  Cleanup     : nspr-4.10.10-2.fc22.x86_64                                31/34 
  Cleanup     : nss-softokn-freebl-3.21.0-1.1.fc22.x86_64                 32/34 
  Cleanup     : pcre-8.38-1.fc22.x86_64                                   33/34 
  Cleanup     : gnupg2-2.1.9-1.fc22.x86_64                                34/34 
  Verifying   : kernel-debug-devel-4.4.5-200.fc22.x86_64                   1/34 
  Verifying   : python-pip-6.0.8-1.fc22.noarch                             2/34 
  Verifying   : sqlite-libs-3.11.0-3.fc22.x86_64                           3/34 
  Verifying   : python-setuptools-17.1.1-3.fc22.noarch                     4/34 
  Verifying   : gnupg2-2.1.11-1.fc22.x86_64                                5/34 
  Verifying   : kernel-headers-4.4.5-200.fc22.x86_64                       6/34 
  Verifying   : libssh2-1.5.0-2.fc22.x86_64                                7/34 
  Verifying   : nspr-4.12.0-1.fc22.x86_64                                  8/34 
  Verifying   : nss-3.23.0-1.0.fc22.x86_64                                 9/34 
  Verifying   : nss-softokn-3.23.0-1.0.fc22.x86_64                        10/34 
  Verifying   : nss-util-3.23.0-1.0.fc22.x86_64                           11/34 
  Verifying   : nss-softokn-freebl-3.23.0-1.0.fc22.x86_64                 12/34 
  Verifying   : nss-tools-3.23.0-1.0.fc22.x86_64                          13/34 
  Verifying   : nss-sysinit-3.23.0-1.0.fc22.x86_64                        14/34 
  Verifying   : openssl-libs-1:1.0.1k-14.fc22.x86_64                      15/34 
  Verifying   : pcre-8.38-3.fc22.x86_64                                   16/34 
  Verifying   : python-2.7.10-8.fc22.x86_64                               17/34 
  Verifying   : python-libs-2.7.10-8.fc22.x86_64                          18/34 
  Verifying   : sqlite-3.11.0-3.fc22.x86_64                               19/34 
  Verifying   : nspr-4.10.10-2.fc22.x86_64                                20/34 
  Verifying   : nss-3.21.0-1.1.fc22.x86_64                                21/34 
  Verifying   : nss-softokn-3.21.0-1.1.fc22.x86_64                        22/34 
  Verifying   : nss-softokn-freebl-3.21.0-1.1.fc22.x86_64                 23/34 
  Verifying   : nss-sysinit-3.21.0-1.1.fc22.x86_64                        24/34 
  Verifying   : nss-tools-3.21.0-1.1.fc22.x86_64                          25/34 
  Verifying   : nss-util-3.21.0-1.0.fc22.x86_64                           26/34 
  Verifying   : gnupg2-2.1.9-1.fc22.x86_64                                27/34 
  Verifying   : libssh2-1.5.0-1.fc22.x86_64                               28/34 
  Verifying   : openssl-libs-1:1.0.1k-13.fc22.x86_64                      29/34 
  Verifying   : kernel-headers-4.4.4-200.fc22.x86_64                      30/34 
  Verifying   : pcre-8.38-1.fc22.x86_64                                   31/34 
  Verifying   : python-2.7.9-6.fc22.x86_64                                32/34 
  Verifying   : sqlite-3.10.2-1.fc22.x86_64                               33/34 
  Verifying   : python-libs-2.7.9-6.fc22.x86_64                           34/34 

Installed:
  kernel-debug-devel.x86_64 4.4.5-200.fc22   python-pip.noarch 6.0.8-1.fc22    
  python-setuptools.noarch 17.1.1-3.fc22     sqlite-libs.x86_64 3.11.0-3.fc22  

Upgraded:
  gnupg2.x86_64 2.1.11-1.fc22                                                   
  kernel-headers.x86_64 4.4.5-200.fc22                                          
  libssh2.x86_64 1.5.0-2.fc22                                                   
  nspr.x86_64 4.12.0-1.fc22                                                     
  nss.x86_64 3.23.0-1.0.fc22                                                    
  nss-softokn.x86_64 3.23.0-1.0.fc22                                            
  nss-softokn-freebl.x86_64 3.23.0-1.0.fc22                                     
  nss-sysinit.x86_64 3.23.0-1.0.fc22                                            
  nss-tools.x86_64 3.23.0-1.0.fc22                                              
  nss-util.x86_64 3.23.0-1.0.fc22                                               
  openssl-libs.x86_64 1:1.0.1k-14.fc22                                          
  pcre.x86_64 8.38-3.fc22                                                       
  python.x86_64 2.7.10-8.fc22                                                   
  python-libs.x86_64 2.7.10-8.fc22                                              
  sqlite.x86_64 3.11.0-3.fc22                                                   

Complete!
# OS package update successful
Not running as root, the following command will be run through "sudo":
    yum install -y m4 ncurses-devel
Not running as root, the following command will be run through "sudo":
    rpm -q m4 ncurses-devel
[91mYum command has been deprecated, redirecting to '/usr/bin/dnf install -y m4 ncurses-devel'.
See 'man dnf' and 'man yum2dnf' for more information.
To transfer transaction metadata from yum to DNF, run:
'dnf install python-dnf-plugins-extras-migrate && dnf-2 migrate'

[0mLast metadata expiration check performed 0:01:21 ago on Wed Mar 23 13:48:15 2016.
Dependencies resolved.
================================================================================
 Package             Arch         Version                    Repository    Size
================================================================================
Installing:
 m4                  x86_64       1.4.17-6.fc22              fedora       264 k
 ncurses-devel       x86_64       5.9-18.20150214.fc22       fedora       731 k

Transaction Summary
================================================================================
Install  2 Packages

Total download size: 995 k
Installed size: 2.7 M
Downloading Packages:
--------------------------------------------------------------------------------
Total                                           616 kB/s | 995 kB     00:01     
Running transaction check
Transaction check succeeded.
Running transaction test
Transaction test succeeded.
Running transaction
  Installing  : ncurses-devel-5.9-18.20150214.fc22.x86_64                   1/2 
warning: Unable to get systemd shutdown inhibition lock
  Installing  : m4-1.4.17-6.fc22.x86_64                                     2/2 
  Verifying   : m4-1.4.17-6.fc22.x86_64                                     1/2 
  Verifying   : ncurses-devel-5.9-18.20150214.fc22.x86_64                   2/2 

Installed:
  m4.x86_64 1.4.17-6.fc22       ncurses-devel.x86_64 5.9-18.20150214.fc22      

Complete!
m4-1.4.17-6.fc22.x86_64
ncurses-devel-5.9-18.20150214.fc22.x86_64
# OS packages installation successful
The following dependencies couldn't be met:
  - planets -> core < 113.24.00
Your request can't be satisfied:
  - core<113.24.00 is not available because your system doesn't comply with ocaml-version >= "4.02.1" & ocaml-version < "4.03".

No solution found, exiting
[91m'opam install -y -j 2 -v planets' failed.
[0mThe command '/bin/sh -c sudo -u opam sh -c "cd /home/opam/opam-repository && git pull origin master && opam update -u" &&   sudo -u opam sh -c "cd /home/opam/opam-repository && git pull https://github.com/UnixJunkie/opam-repository.git cairo-use-conf-autoconf && opam update -u" &&   sudo -u opam sh -c "opam depext -u planets" &&   sudo -u opam sh -c "opam install -y -j 2 -v planets"' returned a non-zero code: 3
